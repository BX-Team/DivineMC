From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: NONPLAYT <76615486+NONPLAYT@users.noreply.github.com>
Date: Sat, 12 Apr 2025 17:40:53 +0300
Subject: [PATCH] SparklyPaper: Allow throttling hopper checks if the target
 container is full

Original project: https://github.com/SparklyPower/SparklyPaper

diff --git a/net/minecraft/world/level/block/entity/HopperBlockEntity.java b/net/minecraft/world/level/block/entity/HopperBlockEntity.java
index 94d68fbb3d152b2fd43f989b728c5efabbf3c22c..2c1d5fd29ad0a3c26aca738d4097126967037319 100644
--- a/net/minecraft/world/level/block/entity/HopperBlockEntity.java
+++ b/net/minecraft/world/level/block/entity/HopperBlockEntity.java
@@ -185,6 +185,11 @@ public class HopperBlockEntity extends RandomizableContainerBlockEntity implemen
         } else {
             Direction opposite = blockEntity.facing.getOpposite();
             if (isFullContainer(attachedContainer, opposite)) {
+                // DivineMC start - SparklyPaper: Allow throttling hopper checks if the target container is full
+                if (org.bxteam.divinemc.DivineConfig.hopperThrottleWhenFull && org.bxteam.divinemc.DivineConfig.hopperThrottleSkipTicks > 0) {
+                    blockEntity.setCooldown(org.bxteam.divinemc.DivineConfig.hopperThrottleSkipTicks);
+                }
+                // DivineMC end - SparklyPaper: Allow throttling hopper checks if the target container is full
                 return false;
             } else {
                 for (int i = 0; i < blockEntity.getContainerSize(); i++) {
